// Time, Space - O(N^2), O(N)
class Solution {
    int[] colors;
    int n;
    public int minMalwareSpread(int[][] graph, int[] initial) {
        n = graph.length;
        colors = new int[n];
        Arrays.fill(colors, -1);
        int color = 0;
        for(int i=0;i<n;i++) {
            if(colors[i] == -1) {
                dfs(i, color, graph);
                color++;
            }
        }
        
        int[] groups = new int[color];
        
        for(int cl : colors) {
            groups[cl]++;
        }
        
        int[] inGroup = new int[color];
        
        for(int in : initial) {
            int cl = colors[in];
            inGroup[cl]++;
        }
        int result = Integer.MAX_VALUE;
        
        for(int node : initial) {
            int cl = colors[node];
            int total = inGroup[cl];
            
            if(total == 1) {
                if(result == Integer.MAX_VALUE) {
                    result = node;         
                }
                else if(groups[cl] > groups[colors[result]]) {
                    result = node;
                }
                else if(groups[cl] == groups[colors[result]] && node < result) {
                    result = node;
                }
            }
        }
        
        if(result == Integer.MAX_VALUE) {
            for(int node : initial) {
                result = Math.min(result,node);
            }
        }
        
        return result;
        
        
    }
    
    private void dfs(int node, int color, int[][] graph) {
        if(colors[node] != -1) {
            return;
        }
        
        colors[node] = color;
        for(int i=0;i<n;i++) {
            if(graph[node][i] == 1) {
                dfs(i, color, graph);
            }
        }
    }
}
